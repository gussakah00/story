(()=>{"use strict";var e,t,i={763:(e,t,i)=>{i.d(t,{y:()=>n});const n=new class{constructor(){this.tokenKey="authToken",this.userKey="userData"}login(e,t){localStorage.setItem(this.tokenKey,e),localStorage.setItem(this.userKey,JSON.stringify(t))}logout(){localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.userKey)}isLoggedIn(){return!!this.getToken()}getToken(){return localStorage.getItem(this.tokenKey)}getUser(){const e=localStorage.getItem(this.userKey);return e?JSON.parse(e):null}getUserName(){const e=this.getUser();return e?e.name:"Pengguna"}}}},n={};function a(e){var t=n[e];if(void 0!==t)return t.exports;var o=n[e]={exports:{}};return i[e](o,o.exports,a),o.exports}a.m=i,a.d=(e,t)=>{for(var i in t)a.o(t,i)&&!a.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce(((t,i)=>(a.f[i](e,t),t)),[])),a.u=e=>e+".main.bundle.js",a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="cerita-di-sekitarmu:",a.l=(i,n,o,r)=>{if(e[i])e[i].push(n);else{var s,c;if(void 0!==o)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==i||d.getAttribute("data-webpack")==t+o){s=d;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",a.nc&&s.setAttribute("nonce",a.nc),s.setAttribute("data-webpack",t+o),s.src=i),e[i]=[n];var h=(t,n)=>{s.onerror=s.onload=null,clearTimeout(g);var a=e[i];if(delete e[i],s.parentNode&&s.parentNode.removeChild(s),a&&a.forEach((e=>e(n))),t)return t(n)},g=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),c&&document.head.appendChild(s)}},a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.p="/story/",(()=>{var e={792:0};a.f.j=(t,i)=>{var n=a.o(e,t)?e[t]:void 0;if(0!==n)if(n)i.push(n[2]);else{var o=new Promise(((i,a)=>n=e[t]=[i,a]));i.push(n[2]=o);var r=a.p+a.u(t),s=new Error;a.l(r,(i=>{if(a.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var o=i&&("load"===i.type?"missing":i.type),r=i&&i.target&&i.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+r+")",s.name="ChunkLoadError",s.type=o,s.request=r,n[1](s)}}),"chunk-"+t,t)}};var t=(t,i)=>{var n,o,[r,s,c]=i,l=0;if(r.some((t=>0!==e[t]))){for(n in s)a.o(s,n)&&(a.m[n]=s[n]);c&&c(a)}for(t&&t(i);l<r.length;l++)o=r[l],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0},i=self.webpackChunkcerita_di_sekitarmu=self.webpackChunkcerita_di_sekitarmu||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var o=a(763);const r=new class{constructor(){this.isSubscribed=!1,this.registration=null,this.subscription=null,this.VAPID_PUBLIC_KEY="BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk",this._isInitialized=!1,this._initPromise=null}async init(){return console.log("PushManager: Initializing..."),this._initPromise||(this._initPromise=new Promise((async(e,t)=>{if(!this._isSupported())return console.log("PushManager: Not supported"),this._isInitialized=!0,void e(!1);try{if(this._isDevelopment()){console.log("PushManager: Development mode - using localStorage");const t=localStorage.getItem("pushSubscription");return this.isSubscribed=!!t,this._isInitialized=!0,void e(!0)}console.log("PushManager: Service Worker ready"),this.subscription=await this.registration.pushManager.getSubscription(),this.isSubscribed=!!this.subscription,this._isInitialized=!0,console.log("PushManager: Initialized, subscribed:",this.isSubscribed),e(!0)}catch(t){if(console.error("PushManager: Init error:",t),this._isDevelopment()){console.log("PushManager: Development fallback to localStorage");const t=localStorage.getItem("pushSubscription");this.isSubscribed=!!t,this._isInitialized=!0,e(!0)}else this._isInitialized=!0,e(!1)}}))),this._initPromise}_isSupported(){const e="serviceWorker"in navigator&&"PushManager"in window;return console.log("PushManager: Supported:",e),e}_isDevelopment(){return"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname}async subscribe(){this._isInitialized||await this.init();try{if(console.log("PushManager: Requesting notification permission..."),"granted"!==await Notification.requestPermission())throw new Error("Izin notifikasi ditolak");if(this._isDevelopment())return console.log("PushManager: Development mode - storing in localStorage"),localStorage.setItem("pushSubscription",JSON.stringify({endpoint:"development-mode",keys:{p256dh:"dev",auth:"dev"}})),this.isSubscribed=!0,this._showLocalNotification("üîî Notifikasi Diaktifkan","Anda akan menerima notifikasi cerita baru."),!0;console.log("PushManager: Permission granted, subscribing..."),this.subscription&&(console.log("PushManager: Unsubscribing existing subscription..."),await this.unsubscribe()),this.subscription=await this.registration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this._urlBase64ToUint8Array(this.VAPID_PUBLIC_KEY)}),this.isSubscribed=!0;const e=this.subscription.toJSON();localStorage.setItem("pushSubscription",JSON.stringify(e)),console.log("PushManager: Subscription created and saved");try{await this._sendSubscriptionToServer(),console.log("PushManager: Subscription sent to server successfully")}catch(e){console.warn("PushManager: Server subscription failed:",e)}return this._showLocalNotification("üîî Notifikasi Diaktifkan","Anda akan menerima notifikasi cerita baru."),!0}catch(e){return console.error("PushManager: Subscribe error:",e),this._showLocalNotification("‚ùå Gagal","Tidak dapat mengaktifkan notifikasi: "+e.message),!1}}async unsubscribe(){console.log("PushManager: Unsubscribing...");try{if(this._isDevelopment())return console.log("PushManager: Development mode - removing from localStorage"),localStorage.removeItem("pushSubscription"),this.isSubscribed=!1,this._showLocalNotification("üîï Notifikasi Dimatikan","Anda tidak akan menerima notifikasi lagi."),!0;this.subscription&&(console.log("PushManager: Unsubscribing from push service..."),await this.subscription.unsubscribe()||console.warn("PushManager: Unsubscribe returned false")),this.subscription=null,this.isSubscribed=!1,localStorage.removeItem("pushSubscription"),console.log("PushManager: Local cleanup complete");try{await this._removeSubscriptionFromServer(),console.log("PushManager: Server unsubscription successful")}catch(e){console.warn("PushManager: Server unsubscription failed:",e)}return this._showLocalNotification("üîï Notifikasi Dimatikan","Anda tidak akan menerima notifikasi lagi."),!0}catch(e){return console.error("PushManager: Unsubscribe error:",e),this.subscription=null,this.isSubscribed=!1,localStorage.removeItem("pushSubscription"),this._showLocalNotification("‚ö†Ô∏è Peringatan","Notifikasi dimatikan secara lokal."),!0}}async _sendSubscriptionToServer(){if(!this.subscription)return{success:!1,error:"No subscription"};const e=localStorage.getItem("authToken");if(!e)return console.log("PushManager: No auth token, skipping server registration"),{success:!1,error:"No auth token"};try{const t=this.subscription.toJSON(),i={endpoint:t.endpoint,keys:{p256dh:t.keys.p256dh,auth:t.keys.auth}};console.log("PushManager: Sending subscription to server");const n=await fetch("https://story-api.dicoding.dev/v1/notifications/subscribe",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(i)});if(!n.ok)throw new Error(`Server returned ${n.status}`);const a=await n.json();return console.log("PushManager: Subscription saved on server"),{success:!0,data:a}}catch(e){return console.warn("PushManager: Failed to save subscription on server:",e),{success:!1,error:e.message}}}async _removeSubscriptionFromServer(){const e=localStorage.getItem("authToken");if(!e)return console.log("PushManager: No auth token, skipping server unsubscription"),{success:!1,error:"No auth token"};let t;if(this.subscription)t=this.subscription.toJSON().endpoint;else{const e=localStorage.getItem("pushSubscription");e&&(t=JSON.parse(e).endpoint)}if(!t)return console.log("PushManager: No endpoint available for server unsubscription"),{success:!1,error:"No endpoint available"};try{const i=await fetch("https://story-api.dicoding.dev/v1/notifications/subscribe",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({endpoint:t})});return i.ok?(console.log("PushManager: Subscription removed from server"),{success:!0}):404===i.status?(console.log("PushManager: Subscription already removed from server"),{success:!0}):{success:!1,error:`Server returned ${i.status}`}}catch(e){return console.warn("PushManager: Failed to remove subscription from server:",e),{success:!1,error:e.message}}}_showLocalNotification(e,t){if("Notification"in window&&"granted"===Notification.permission)try{new Notification(e,{body:t,icon:"/icons/icon-192x192.png"})}catch(i){alert(`${e}: ${t}`)}else alert(`${e}: ${t}`)}_urlBase64ToUint8Array(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),i=window.atob(t),n=new Uint8Array(i.length);for(let e=0;e<i.length;++e)n[e]=i.charCodeAt(e);return n}getStatus(){const e=localStorage.getItem("pushSubscription");return this.isSubscribed=!!e,{isSubscribed:this.isSubscribed,isSupported:this._isSupported(),permission:Notification.permission,isInitialized:this._isInitialized}}},s=new class{constructor(){this.navElement=null,this.updateNavigation=this.updateNavigation.bind(this),this._isPushManagerInitialized=!1,this._isInitialized=!1}async init(){this._isInitialized?console.log("Navigation: Already initialized, skipping..."):(this.navElement=document.getElementById("nav-list"),this.updateNavigation(),window.addEventListener("authchange",this.updateNavigation),o.y.isLoggedIn()&&(console.log("Navigation: Initializing push manager..."),await this._initializePushManager()),this._isInitialized=!0)}async _initializePushManager(){try{await r.init(),this._isPushManagerInitialized=!0,console.log("Navigation: Push manager initialized successfully"),this._updateNotificationUI()}catch(e){console.error("Navigation: Failed to initialize push manager:",e),this._isPushManagerInitialized=!1}}updateNavigation(){if(!this.navElement)return;const e=o.y.isLoggedIn(),t=o.y.getUserName();if(e){this.navElement.innerHTML=`\n        <li><a href="#/beranda" class="nav-link">Beranda</a></li>\n        <li><a href="#/about" class="nav-link">About</a></li>\n        <li><a href="#/add" class="nav-link">Tambah Cerita</a></li>\n        <li><a href="#/favorites" class="nav-link">Favorit</a></li>\n        <li><a href="#/offline" class="nav-link">Offline</a></li>\n        <li class="nav-user">\n          <span class="user-name">Halo, ${t}</span>\n          <div class="notification-controls">\n            <button id="enable-notifications" class="notification-toggle-btn" style="display: none;">\n              üîî Aktifkan Notifikasi\n            </button>\n            <button id="disable-notifications" class="notification-toggle-btn secondary" style="display: none;">\n              üîï Matikan Notifikasi\n            </button>\n          </div>\n          <button id="logout-btn" class="logout-button" aria-label="Keluar dari akun">Keluar</button>\n        </li>\n      `;const e=document.getElementById("logout-btn");e&&e.addEventListener("click",this.handleLogout.bind(this)),this._setupNotificationControls()}else this.navElement.innerHTML='\n        <li><a href="#/about" class="nav-link">About</a></li>\n        <li><a href="#/login" class="nav-link">Masuk</a></li>\n        <li><a href="#/register" class="nav-link">Daftar</a></li>\n      '}_setupNotificationControls(){console.log("Navigation: Setting up notification controls...");const e=document.getElementById("enable-notifications"),t=document.getElementById("disable-notifications");e&&t&&(this._updateNotificationUI(),e.addEventListener("click",(async()=>{console.log("Enable notifications clicked"),this._isPushManagerInitialized||(console.log("Push manager not ready, initializing..."),await r.init(),this._isPushManagerInitialized=!0),await r.subscribe()?(this._updateNotificationUI(),this._showNotificationMessage("Notifikasi berhasil diaktifkan","success")):this._showNotificationMessage("Gagal mengaktifkan notifikasi","error")})),t.addEventListener("click",(async()=>{console.log("Disable notifications clicked"),this._isPushManagerInitialized||(console.log("Push manager not ready, initializing..."),await r.init(),this._isPushManagerInitialized=!0),await r.unsubscribe()?(this._updateNotificationUI(),this._showNotificationMessage("Notifikasi berhasil dimatikan","success")):this._showNotificationMessage("Gagal mematikan notifikasi","error")}))),console.log("Navigation: Notification controls setup complete")}_showNotificationMessage(e,t){const i=document.createElement("div");i.textContent=e,i.style.cssText=`\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      padding: 12px 20px;\n      background: ${"success"===t?"#4CAF50":"#f44336"};\n      color: white;\n      border-radius: 4px;\n      z-index: 10000;\n      box-shadow: 0 2px 10px rgba(0,0,0,0.2);\n    `,document.body.appendChild(i),setTimeout((()=>{i.parentNode&&i.parentNode.removeChild(i)}),3e3)}_updateNotificationUI(){const e=document.getElementById("enable-notifications"),t=document.getElementById("disable-notifications");if(!e||!t)return;const i=r.getStatus();if(console.log("Navigation: Current notification status:",i),i.isSubscribed?(e.style.display="none",t.style.display="inline-block"):(e.style.display="inline-block",t.style.display="none"),!i.isSupported){e.style.display="none",t.style.display="none";const i=document.querySelector(".notification-controls");if(i&&!i.querySelector(".unsupported-message")){const e=document.createElement("div");e.className="unsupported-message",e.textContent="Notifikasi tidak didukung di browser ini",e.style.cssText="\n          font-size: 12px;\n          color: #666;\n          margin-top: 5px;\n          text-align: center;\n        ",i.appendChild(e)}}}handleLogout(){if(confirm("Apakah Anda yakin ingin keluar?")){o.y.logout(),window.dispatchEvent(new Event("authchange")),window.location.hash="#/about";const e=document.getElementById("main-content");e&&(e.innerHTML='\n          <div style="text-align: center; padding: 40px;">\n            <h1>Berhasil Keluar</h1>\n            <p>Anda telah berhasil keluar dari akun.</p>\n            <p>Mengarahkan ke halaman about...</p>\n          </div>\n        ')}}},c={"/beranda":()=>a.e(395).then(a.bind(a,395)),"/about":()=>a.e(283).then(a.bind(a,283)),"/add":()=>a.e(611).then(a.bind(a,611)),"/login":()=>a.e(408).then(a.bind(a,408)),"/register":()=>a.e(724).then(a.bind(a,724)),"/favorites":()=>a.e(327).then(a.bind(a,327)),"/offline":()=>a.e(451).then(a.bind(a,451))},l=new class{constructor(){this.registration=null,this.isActive=!1}async init(){if(!("serviceWorker"in navigator))return console.log("‚ùå Service Worker tidak didukung browser ini"),!1;try{return console.log("üöÄ Mengaktifkan Service Worker..."),await this.cleanupOldSW(),await this.registerSW(),this.setupAutoUpdate(),console.log("‚úÖ Service Worker berhasil diaktifkan"),!0}catch(e){return console.error("‚ùå Gagal mengaktifkan Service Worker:",e),!1}}async cleanupOldSW(){try{const e=await navigator.serviceWorker.getRegistrations();if(0===e.length)return void console.log("‚ÑπÔ∏è Tidak ada Service Worker lama");console.log(`üóëÔ∏è Membersihkan ${e.length} Service Worker lama...`);const t=e.map((async e=>{try{return await e.unregister(),console.log("‚úÖ Berhasil unregister SW:",e.scope),!0}catch(e){return console.error("‚ùå Gagal unregister SW:",e),!1}}));await Promise.all(t),console.log("‚úÖ Semua Service Worker lama dibersihkan")}catch(e){console.error("‚ùå Error saat membersihkan SW lama:",e)}}async registerSW(){try{const e=this.getSWUrl();return console.log("üìÅ Registering Service Worker:",e),this.registration=await navigator.serviceWorker.register(e,{scope:"./",updateViaCache:"none"}),console.log("‚úÖ Service Worker terdaftar:",this.registration.scope),await this.waitForActivation(),this.registration}catch(e){throw console.error("‚ùå Gagal register Service Worker:",e),e}}getSWUrl(){return"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"/sw.js":window.location.hostname.includes("github.io")?`/${window.location.pathname.split("/")[1]||"revisi2"}/sw.js`:"/sw.js"}async waitForActivation(){return new Promise(((e,t)=>{if(!this.registration)return void t(new Error("No registration found"));if(this.registration.active)return this.isActive=!0,console.log("üéâ Service Worker sudah aktif"),void e(this.registration);const i=this.registration.installing;i?i.addEventListener("statechange",(()=>{console.log(`üîÑ Status Service Worker: ${i.state}`),"activated"===i.state&&(this.isActive=!0,console.log("üéâ Service Worker berhasil diaktifkan!"),e(this.registration)),"redundant"===i.state&&t(new Error("Service Worker menjadi redundant"))})):this.registration.addEventListener("updatefound",(()=>{const t=this.registration.installing;console.log("üîÑ Service Worker baru ditemukan:",t.state),t.addEventListener("statechange",(()=>{console.log(`üîÑ Status SW baru: ${t.state}`),"activated"===t.state&&(this.isActive=!0,console.log("üéâ Service Worker baru diaktifkan!"),e(this.registration))}))})),setTimeout((()=>{this.isActive||t(new Error("Service Worker activation timeout"))}),1e4)}))}setupAutoUpdate(){this.registration&&(setInterval((async()=>{try{console.log("üîç Memeriksa update Service Worker..."),await this.registration.update(),console.log("‚úÖ Update check selesai")}catch(e){console.error("‚ùå Gagal check update:",e)}}),36e5),navigator.serviceWorker.addEventListener("controllerchange",(()=>{console.log("üîÑ Controller Service Worker berubah"),this.isActive=!0})))}async forceUpdate(){if(!this.registration)return console.log("‚ùå Tidak ada Service Worker yang terdaftar"),!1;try{return console.log("üîÑ Memaksa update Service Worker..."),await this.registration.update(),console.log("‚úÖ Force update berhasil"),!0}catch(e){return console.error("‚ùå Gagal force update:",e),!1}}async unregister(){try{return await this.cleanupOldSW(),this.registration=null,this.isActive=!1,console.log("‚úÖ Semua Service Worker di-unregister"),!0}catch(e){return console.error("‚ùå Gagal unregister:",e),!1}}getStatus(){return{isActive:this.isActive,scope:this.registration?.scope||null,controller:!!navigator.serviceWorker.controller}}},u=()=>l.init(),d=()=>l.getStatus();"undefined"!=typeof window&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>{setTimeout((()=>l.init()),1e3)})):setTimeout((()=>l.init()),1e3)),console.log("üöÄ Service Worker Manager loaded"),console.log("üöÄ Memulai Cerita di Sekitarmu...");const h=new class{_content=null;_drawerButton=null;_navigationDrawer=null;_isRendering=!1;_currentPage=null;_previousRoute=null;_currentRoute=null;_pageOrder={"/beranda":1,"/about":2,"/add":3,"/favorites":4,"/offline":5,"/login":6,"/register":7};constructor({navigationDrawer:e,drawerButton:t,content:i}){this._content=i,this._drawerButton=t,this._navigationDrawer=e,this._isRendering=!1,this._currentPage=null,this._previousRoute=null,this._currentRoute=null,this._setupDrawer(),this._setupSkipLink(),this._initRouter(),this._initNavigation()}_initNavigation(){s.init()}_initRouter(){const e=(e=>{let t;return function(...i){clearTimeout(t),t=setTimeout((()=>{clearTimeout(t),e(...i)}),100)}})((()=>this.renderPage()));window.addEventListener("hashchange",e),window.addEventListener("load",(()=>this.renderPage())),window.addEventListener("authchange",(()=>{this.renderPage(),s.init()}))}_setupDrawer(){this._drawerButton&&this._navigationDrawer?(this._drawerButton.addEventListener("click",(()=>{const e=this._navigationDrawer.classList.toggle("open");this._drawerButton.setAttribute("aria-expanded",e),e?(this._drawerButton.innerHTML="‚úï",this._drawerButton.setAttribute("aria-label","Tutup menu navigasi")):(this._drawerButton.innerHTML="‚ò∞",this._drawerButton.setAttribute("aria-label","Buka menu navigasi"))})),document.body.addEventListener("click",(e=>{this._navigationDrawer.contains(e.target)||this._drawerButton.contains(e.target)||!this._navigationDrawer.classList.contains("open")||(this._navigationDrawer.classList.remove("open"),this._drawerButton.setAttribute("aria-expanded","false"),this._drawerButton.innerHTML="‚ò∞",this._drawerButton.setAttribute("aria-label","Buka menu navigasi"))})),this._navigationDrawer.querySelectorAll("a").forEach((e=>{e.addEventListener("click",(()=>{window.innerWidth<768&&(this._navigationDrawer.classList.remove("open"),this._drawerButton.setAttribute("aria-expanded","false"),this._drawerButton.innerHTML="‚ò∞",this._drawerButton.setAttribute("aria-label","Buka menu navigasi"))}))}))):console.error("Drawer elements not found in DOM.")}_setupSkipLink(){const e=document.querySelector(".skip-link"),t=document.querySelector("#main-content");e&&t&&e.addEventListener("click",(e=>{e.preventDefault(),t.focus(),t.scrollIntoView({behavior:"smooth"})}))}async renderPage(){if(this._content)if(this._isRendering)console.log("App: Already rendering, skipping...");else{this._isRendering=!0;try{let e=function(e){let t="";return e.resource&&(t=t.concat(`/${e.resource}`)),e.id&&(t=t.concat("/:id")),t||"/"}(function(e){const t=e.split("/");return{resource:t[1]||null,id:t[2]||null}}(location.hash.replace("#","")||"/beranda"));if(!e||"#"===e||"/"===e)return e=o.y.isLoggedIn()?"#/beranda":"#/about",window.location.hash=e,void(this._isRendering=!1);if(!o.y.isLoggedIn()&&["/beranda","/add","/favorites","/offline"].includes(e))return e="#/about",window.location.hash=e,void(this._isRendering=!1);if(o.y.isLoggedIn()&&["/login","/register"].includes(e))return e="#/beranda",window.location.hash=e,void(this._isRendering=!1);const t=c[e];if(!t)return this._showErrorPage("404 - Halaman Tidak Ditemukan","Halaman yang Anda cari tidak ditemukan."),void(this._isRendering=!1);const i=this._getTransitionDirection(e);if(console.log(`üîÑ Navigation: ${this._previousRoute} ‚Üí ${e} (${i})`),document.startViewTransition){console.log(`üé¨ Using View Transition with direction: ${i}`),this._content.classList.remove("forward-transition","backward-transition","none-transition"),this._content.classList.add(`${i}-transition`);const n=document.startViewTransition((async()=>{await this._renderPageContent(t,e,i)}));await n.finished,setTimeout((()=>{this._content.classList.remove(`${i}-transition`)}),400)}else console.log("‚ö†Ô∏è View Transitions not supported, using fallback"),await this._renderPageContent(t,e,i);this._previousRoute=this._currentRoute,this._currentRoute=e}catch(e){console.error("Error rendering page:",e),this._showErrorPage("Terjadi Kesalahan","Maaf, terjadi kesalahan saat menampilkan halaman.")}finally{this._isRendering=!1}}else console.error("Content container not found in DOM.")}async _renderPageContent(e,t,i){this._currentPage&&"function"==typeof this._currentPage.cleanup&&await this._currentPage.cleanup(),this._content.style.opacity="0.7",await new Promise((e=>setTimeout(e,50)));const n=(await e()).default;if(this._content.innerHTML=await n.render(),this._currentPage=n,"function"==typeof n.afterRender)try{await n.afterRender()}catch(e){console.error("Error in afterRender:",e)}this._content.style.opacity="1",this._updateDocumentTitle(t),window.scrollTo({top:0,behavior:"smooth"})}_getTransitionDirection(e){if(!this._currentRoute)return"none";const t=this._pageOrder[this._currentRoute]||0,i=this._pageOrder[e]||0;return i>t?"forward":i<t?"backward":"none"}_showErrorPage(e,t){this._content.innerHTML=`\n      <section class="error-page" style="text-align: center; padding: 60px 20px;">\n        <h1>${e}</h1>\n        <p style="margin: 20px 0; color: #666;">${t}</p>\n        <div style="margin-top: 30px;">\n          <a href="#/beranda" class="primary-button" style="margin-right: 10px;">üè† Ke Beranda</a>\n          <a href="#/about" class="secondary-button">‚ÑπÔ∏è Ke About</a>\n        </div>\n      </section>\n    `,this._content.style.opacity=1}_updateDocumentTitle(e){document.title={"/beranda":"Beranda - Cerita di Sekitarmu","/about":"Tentang - Cerita di Sekitarmu","/add":"Tambah Cerita - Cerita di Sekitarmu","/login":"Masuk - Cerita di Sekitarmu","/register":"Daftar - Cerita di Sekitarmu","/favorites":"Favorit - Cerita di Sekitarmu","/offline":"Offline - Cerita di Sekitarmu"}[e]||"Cerita di Sekitarmu"}refresh(){this.renderPage()}isUserLoggedIn(){return o.y.isLoggedIn()}getUserInfo(){return o.y.getUser()}}({drawerButton:document.querySelector("#drawer-button"),navigationDrawer:document.querySelector("#navigation-drawer"),content:document.querySelector("#main-content")});let g=!1;window.addEventListener("hashchange",(()=>h.renderPage())),window.addEventListener("load",(async()=>{g||(g=!0,await h.renderPage(),console.log("‚úÖ Aplikasi berhasil dimulai"),await async function(){try{if(console.log("üì± Mengaktifkan fitur PWA..."),await u()){console.log("‚úÖ Service Worker aktif");const e=d();console.log("üìä Status Service Worker:",e)}else console.log("‚ÑπÔ∏è Service Worker tidak aktif (development mode)");setTimeout((async()=>{await async function(){try{await r.init()?(await s.init(),console.log("‚úÖ Push notifications aktif")):console.log("‚ÑπÔ∏è Push notifications tidak didukung")}catch(e){console.error("‚ùå Gagal mengaktifkan push notifications:",e)}}()}),2e3),console.log("‚úÖ Semua fitur PWA diaktifkan")}catch(e){console.error("‚ùå Gagal mengaktifkan PWA:",e)}}())})),window.enableSW=u,window.swStatus=d,window.app=h})();