"use strict";(self.webpackChunkcerita_di_sekitarmu=self.webpackChunkcerita_di_sekitarmu||[]).push([[724],{188:(e,a,t)=>{t.d(a,{DY:()=>l,Lx:()=>o,ZO:()=>s,y_:()=>i});var r=t(763);const n="https://story-api.dicoding.dev/v1";async function s(){const e=r.y.getToken();if(!e)return console.log("User belum login, tidak bisa mengambil data stories"),[];try{console.log("ðŸ” DEBUG - Fetching stories from API...");const a=new AbortController,t=setTimeout((()=>a.abort()),1e4),r=await fetch(`${n}/stories`,{headers:{Authorization:`Bearer ${e}`},signal:a.signal});if(clearTimeout(t),!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const s=await r.json();return console.log("ðŸ” DEBUG - Full API Response:",s),s.error||!s.listStory?(console.error("API returned error:",s.message),[]):s.listStory.map((e=>{let a=e.photoUrl;return e.photoUrl&&e.photoUrl.startsWith("http")||(a="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZGRkIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkdhbWJhciB0aWRhayB0ZXJzZWRpYTwvdGV4dD48L3N2Zz4="),{id:e.id,name:e.name,description:e.description,photoUrl:a,lat:e.lat,lon:e.lon,createdAt:e.createdAt}}))}catch(e){return console.error("âŒ Error fetching stories:",e),"AbortError"===e.name?console.error("Request timeout - API server mungkin lambat"):"TypeError"===e.name&&e.message.includes("Failed to fetch")&&console.error("Network error - Tidak bisa connect ke API server"),[]}}async function i({description:e,photo:a,lat:t,lon:s}){const i=r.y.getToken();if(!i)return{error:!0,message:"Anda harus login untuk menambah cerita."};const o=new FormData;o.append("description",e),o.append("photo",a),t&&o.append("lat",t),s&&o.append("lon",s);try{console.log("ðŸ” DEBUG - Mulai mengirim cerita ke API...");const e=new AbortController,a=setTimeout((()=>e.abort()),3e4),t=await fetch(`${n}/stories`,{method:"POST",body:o,headers:{Authorization:`Bearer ${i}`},signal:e.signal});clearTimeout(a),console.log("ðŸ” DEBUG - Response status:",t.status);const r=await t.json();return console.log("ðŸ” DEBUG - Response data:",r),!t.ok||r.error?{error:!0,message:r.message||`Error ${t.status}: ${t.statusText}`}:(console.log("ðŸ” DEBUG - Cerita berhasil dikirim:",r),r)}catch(e){return console.error("ðŸ” DEBUG - Error detail:",e),"AbortError"===e.name?{error:!0,message:"Request timeout - Server terlalu lama merespon."}:"TypeError"===e.name&&e.message.includes("Failed to fetch")?{error:!0,message:"Gagal terhubung ke server. Periksa koneksi internet Anda."}:{error:!0,message:`Gagal mengirim data: ${e.message}`}}}async function o({email:e,password:a}){try{const t=new AbortController,r=setTimeout((()=>t.abort()),1e4),s=await fetch(`${n}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:a}),signal:t.signal});clearTimeout(r);const i=await s.json();return s.ok?{error:!1,data:i}:{error:!0,message:i.message||"Login gagal"}}catch(e){return"AbortError"===e.name?{error:!0,message:"Request timeout - Server terlalu lama merespon."}:{error:!0,message:"Terjadi kesalahan jaringan"}}}async function l({name:e,email:a,password:t}){try{const r=new AbortController,s=setTimeout((()=>r.abort()),1e4),i=await fetch(`${n}/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:a,password:t}),signal:r.signal});clearTimeout(s);const o=await i.json();return i.ok?{error:!1,data:o}:{error:!0,message:o.message||"Pendaftaran gagal"}}catch(e){return"AbortError"===e.name?{error:!0,message:"Request timeout - Server terlalu lama merespon."}:{error:!0,message:"Terjadi kesalahan jaringan"}}}},724:(e,a,t)=>{t.r(a),t.d(a,{default:()=>n});var r=t(188);const n={render:async()=>'\n      <section class="auth-page" aria-labelledby="register-title">\n        <h1 id="register-title" tabindex="0">Buat Akun Baru</h1>\n        <form id="registerForm" class="auth-form" aria-labelledby="register-title" autocomplete="off">\n          <div class="form-group">\n            <label for="register-name">Nama:</label>\n            <input \n              type="text" \n              id="register-name" \n              name="name" \n              required \n              aria-required="true"\n              placeholder="Masukkan nama lengkap Anda"\n              autocomplete="name"\n              aria-describedby="name-help"\n            >\n            <p id="name-help" class="form-help">Masukkan nama lengkap Anda</p>\n            <p id="name-error" class="error-message" aria-live="polite"></p>\n          </div>\n          \n          <div class="form-group">\n            <label for="register-email">Email:</label>\n            <input \n              type="email" \n              id="register-email" \n              name="email" \n              required \n              aria-required="true"\n              placeholder="Masukkan email Anda"\n              autocomplete="email"\n              aria-describedby="email-help"\n            >\n            <p id="email-help" class="form-help">Masukkan alamat email yang valid</p>\n            <p id="email-error" class="error-message" aria-live="polite"></p>\n          </div>\n          \n          <div class="form-group">\n            <label for="register-password">Kata Sandi:</label>\n            <input \n              type="password" \n              id="register-password" \n              name="password" \n              required \n              aria-required="true"\n              placeholder="Buat kata sandi (minimal 6 karakter)"\n              autocomplete="new-password"\n              aria-describedby="password-help"\n            >\n            <p id="password-help" class="form-help">Buat kata sandi yang kuat</p>\n            <p id="password-error" class="error-message" aria-live="polite"></p>\n          </div>\n          \n          <div class="form-group">\n            <label for="register-confirmPassword">Konfirmasi Kata Sandi:</label>\n            <input \n              type="password" \n              id="register-confirmPassword" \n              name="confirmPassword" \n              required \n              aria-required="true"\n              placeholder="Ulangi kata sandi Anda"\n              autocomplete="new-password"\n              aria-describedby="confirmPassword-help"\n            >\n            <p id="confirmPassword-help" class="form-help">Ketik ulang kata sandi Anda</p>\n            <p id="confirmPassword-error" class="error-message" aria-live="polite"></p>\n          </div>\n          \n          <button type="submit" class="submit-button">Daftar</button>\n          <p class="auth-link">\n            Sudah punya akun? <a href="#/login" class="link">Masuk di sini</a>\n          </p>\n        </form>\n        <div id="auth-message" class="info-message" aria-live="polite" style="display:none;"></div>\n      </section>\n    ',async afterRender(){this._setupFormValidation(),this._setupFormSubmission()},_setupFormValidation(){document.getElementById("registerForm");const e=document.getElementById("register-name"),a=document.getElementById("register-email"),t=document.getElementById("register-password"),r=document.getElementById("register-confirmPassword");e.addEventListener("blur",(()=>{const a=e.value.trim(),t=document.getElementById("name-error");a?a.length<3?(t.textContent="Nama minimal 3 karakter",e.setAttribute("aria-invalid","true")):(t.textContent="",e.setAttribute("aria-invalid","false")):(t.textContent="Nama harus diisi",e.setAttribute("aria-invalid","true"))})),a.addEventListener("blur",(()=>{const e=a.value.trim(),t=document.getElementById("email-error");e?(e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))(e)?(t.textContent="",a.setAttribute("aria-invalid","false")):(t.textContent="Format email tidak valid",a.setAttribute("aria-invalid","true")):(t.textContent="Email harus diisi",a.setAttribute("aria-invalid","true"))})),t.addEventListener("blur",(()=>{const e=t.value,a=document.getElementById("password-error");e?e.length<6?(a.textContent="Kata sandi minimal 6 karakter",t.setAttribute("aria-invalid","true")):(a.textContent="",t.setAttribute("aria-invalid","false")):(a.textContent="Kata sandi harus diisi",t.setAttribute("aria-invalid","true"))})),r.addEventListener("blur",(()=>{const e=t.value,a=r.value,n=document.getElementById("confirmPassword-error");a?e!==a?(n.textContent="Kata sandi tidak cocok",r.setAttribute("aria-invalid","true")):(n.textContent="",r.setAttribute("aria-invalid","false")):(n.textContent="Konfirmasi kata sandi harus diisi",r.setAttribute("aria-invalid","true"))})),setTimeout((()=>{e.value="",a.value="",t.value="",r.value=""}),100)},_setupFormSubmission(){const e=document.getElementById("registerForm"),a=document.getElementById("auth-message");e.addEventListener("submit",(async t=>{t.preventDefault();const n=document.getElementById("register-name").value.trim(),s=document.getElementById("register-email").value.trim(),i=document.getElementById("register-password").value;if(!n||!s||!i)return a.textContent="Harap isi semua field yang diperlukan",a.style.display="block",void(a.style.backgroundColor="#fee");const o=e.querySelector(".submit-button");o.disabled=!0,o.textContent="Memproses...",a.textContent="Mendaftarkan akun...",a.style.display="block",a.style.backgroundColor="#e3f2fd";try{const e=await(0,r.DY)({name:n,email:s,password:i});if(e.error)throw new Error(e.message);a.textContent="Pendaftaran berhasil! Silakan masuk.",a.style.backgroundColor="#e8f5e8",setTimeout((()=>{window.location.hash="#/login"}),2e3)}catch(e){a.textContent=`Pendaftaran gagal: ${e.message}`,a.style.backgroundColor="#fee",o.disabled=!1,o.textContent="Daftar"}}))}}}}]);